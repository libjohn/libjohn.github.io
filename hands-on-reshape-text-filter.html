<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>OpenRefine for Data Cleaning</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This lab workbook contains hands-on material supplementing the OpenRefine workshops taught by John Little and hosted by the Data &amp; Visualization Services Department, Duke University Libraries.">
  <meta name="generator" content="bookdown 0.3.4 and GitBook 2.6.7">

  <meta property="og:title" content="OpenRefine for Data Cleaning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This lab workbook contains hands-on material supplementing the OpenRefine workshops taught by John Little and hosted by the Data &amp; Visualization Services Department, Duke University Libraries." />
  <meta name="github-repo" content="libjohn/openrefine" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="OpenRefine for Data Cleaning" />
  
  <meta name="twitter:description" content="This lab workbook contains hands-on material supplementing the OpenRefine workshops taught by John Little and hosted by the Data &amp; Visualization Services Department, Duke University Libraries." />
  

<meta name="author" content="John Little">


<meta name="date" content="2016-12-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="grel.html">
<link rel="next" href="hands-on-dates.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css?" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html"><i class="fa fa-check"></i>Workshop Outline</a><ul>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#workshop-structure"><i class="fa fa-check"></i>Workshop Structure</a><ul>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#testimonial"><i class="fa fa-check"></i>Testimonial</a></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#for-best-results"><i class="fa fa-check"></i>For best results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#workshop-philosophy"><i class="fa fa-check"></i>Workshop Philosophy</a></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#comparative-advantage"><i class="fa fa-check"></i>Comparative Advantage</a></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#characteristics"><i class="fa fa-check"></i>Characteristics</a><ul>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#general"><i class="fa fa-check"></i>General</a></li>
<li class="chapter" data-level="" data-path="workshop-outline.html"><a href="workshop-outline.html#video"><i class="fa fa-check"></i>Video</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html"><i class="fa fa-check"></i>Demonstration</a><ul>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#navigating-the-project"><i class="fa fa-check"></i>Navigating the “Project”</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#facets"><i class="fa fa-check"></i>Facets</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#rows-vs.records"><i class="fa fa-check"></i>Rows vs. Records</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#web-scrape-api"><i class="fa fa-check"></i>Web Scrape &amp; API</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#parsing-data"><i class="fa fa-check"></i>Parsing Data</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#split"><i class="fa fa-check"></i>Split</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#concatenate"><i class="fa fa-check"></i>Concatenate</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#find-replace"><i class="fa fa-check"></i>Find &amp; Replace</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#facet-by-blank"><i class="fa fa-check"></i>Facet by Blank</a></li>
<li class="chapter" data-level="" data-path="demonstration.html"><a href="demonstration.html#custom-facet"><i class="fa fa-check"></i>Custom Facet</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html"><i class="fa fa-check"></i><b>1</b> Hands-on: basic transformations</a><ul>
<li class="chapter" data-level="1.1" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#getting-started"><i class="fa fa-check"></i><b>1.1</b> Getting Started</a></li>
<li class="chapter" data-level="1.2" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#shutting-down-openrefine"><i class="fa fa-check"></i><b>1.2</b> Shutting Down OpenRefine</a></li>
<li class="chapter" data-level="1.3" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#facets-cluster"><i class="fa fa-check"></i><b>1.3</b> Facets &amp; Cluster</a><ul>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#facets-1"><i class="fa fa-check"></i>Facets</a></li>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#clustering"><i class="fa fa-check"></i>Clustering</a></li>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#mass-editing"><i class="fa fa-check"></i>Mass Editing</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#split-data-in-cells"><i class="fa fa-check"></i><b>1.4</b> Split data in cells</a></li>
<li class="chapter" data-level="1.5" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#concatenate-cells-together"><i class="fa fa-check"></i><b>1.5</b> Concatenate cells together</a></li>
<li class="chapter" data-level="1.6" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#more-transformations"><i class="fa fa-check"></i><b>1.6</b> More Transformations</a><ul>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#data-types"><i class="fa fa-check"></i>Data Types</a></li>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#whitespace"><i class="fa fa-check"></i>Whitespace</a></li>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#search-replace"><i class="fa fa-check"></i>Search &amp; Replace</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#web-scraping"><i class="fa fa-check"></i><b>1.7</b> Web Scraping</a><ul>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#select-a-subset"><i class="fa fa-check"></i>Select a subset</a></li>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#api"><i class="fa fa-check"></i>API</a></li>
<li class="chapter" data-level="" data-path="hands-on-basic-transformations.html"><a href="hands-on-basic-transformations.html#parse"><i class="fa fa-check"></i>Parse</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="grel.html"><a href="grel.html"><i class="fa fa-check"></i><b>2</b> Hands-on: GREL</a><ul>
<li class="chapter" data-level="2.1" data-path="grel.html"><a href="grel.html#custom-facets"><i class="fa fa-check"></i><b>2.1</b> Custom Facets</a><ul>
<li class="chapter" data-level="" data-path="grel.html"><a href="grel.html#download-new-data-then-create-a-new-openrefine-project"><i class="fa fa-check"></i>Download new Data then Create a new OpenRefine Project:</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="grel.html"><a href="grel.html#grel-to-transform-and-normalize"><i class="fa fa-check"></i><b>2.2</b> GREL to Transform and Normalize</a><ul>
<li class="chapter" data-level="" data-path="grel.html"><a href="grel.html#regular-expression"><i class="fa fa-check"></i>Regular Expression</a></li>
<li class="chapter" data-level="" data-path="grel.html"><a href="grel.html#filter"><i class="fa fa-check"></i>Filter</a></li>
<li class="chapter" data-level="" data-path="grel.html"><a href="grel.html#facet"><i class="fa fa-check"></i>Facet</a></li>
<li class="chapter" data-level="" data-path="grel.html"><a href="grel.html#cluster"><i class="fa fa-check"></i>Cluster</a></li>
<li class="chapter" data-level="" data-path="grel.html"><a href="grel.html#mass-editing-1"><i class="fa fa-check"></i>Mass Editing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hands-on-reshape-text-filter.html"><a href="hands-on-reshape-text-filter.html"><i class="fa fa-check"></i><b>3</b> Hands-on: reshape &amp; text filter</a><ul>
<li class="chapter" data-level="3.1" data-path="hands-on-reshape-text-filter.html"><a href="hands-on-reshape-text-filter.html#ingest-excel-data"><i class="fa fa-check"></i><b>3.1</b> Ingest Excel data</a></li>
<li class="chapter" data-level="3.2" data-path="hands-on-reshape-text-filter.html"><a href="hands-on-reshape-text-filter.html#facets-2"><i class="fa fa-check"></i><b>3.2</b> Facets</a></li>
<li class="chapter" data-level="3.3" data-path="hands-on-reshape-text-filter.html"><a href="hands-on-reshape-text-filter.html#text-filter"><i class="fa fa-check"></i><b>3.3</b> Text Filter</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hands-on-dates.html"><a href="hands-on-dates.html"><i class="fa fa-check"></i><b>4</b> Hands-on: dates</a><ul>
<li class="chapter" data-level="4.1" data-path="hands-on-dates.html"><a href="hands-on-dates.html#dates"><i class="fa fa-check"></i><b>4.1</b> Dates</a></li>
<li class="chapter" data-level="4.2" data-path="hands-on-dates.html"><a href="hands-on-dates.html#logic"><i class="fa fa-check"></i><b>4.2</b> Logic</a></li>
<li class="chapter" data-level="4.3" data-path="hands-on-dates.html"><a href="hands-on-dates.html#reproducible"><i class="fa fa-check"></i><b>4.3</b> Reproducible</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span><ul>
<li class="chapter" data-level="" data-path=""><a href="#hands-on-answers"><i class="fa fa-check"></i>Hands-on Answers</a><ul>
<li class="chapter" data-level="" data-path="hands-on-dates.html"><a href="hands-on-dates.html#appendix-facets"><i class="fa fa-check"></i>facets</a></li>
<li class="chapter" data-level="" data-path="hands-on-dates.html"><a href="hands-on-dates.html#appendix-cluster"><i class="fa fa-check"></i>cluster</a></li>
<li class="chapter" data-level="" data-path="hands-on-dates.html"><a href="hands-on-dates.html#appendix-mass-edit"><i class="fa fa-check"></i>mass edit cells</a></li>
<li class="chapter" data-level="" data-path="hands-on-dates.html"><a href="hands-on-dates.html#custom-facets-1"><i class="fa fa-check"></i>custom Facets</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">OpenRefine for Data Cleaning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hands-on-reshape-text-filter" class="section level1">
<h1><span class="header-section-number">3</span> Hands-on: reshape &amp; text filter</h1>
<p><strong>Reshaping Your Data</strong></p>
<p>For this project you will take data in one format and reshape into a more optimal format for analysis. We’ll assume the analysis will be done in another tool. OpenRefine can export data in multiple formats after the user has applied the necessary structure. For this lab, We will continue exploring how OpenRefine can import various data formats. This time we’ll import Excel. I encourage you to download and first look at the raw Excel data first in Excel so you can see how you have changed the data.</p>
<p><strong>Goals</strong><br />
1. Import Excel worksheets<br />
2. Faceting &amp; Filtering for select data cleaning<br />
3. Transforming: Adding columns and using fill-down to fill in data</p>
<p>Basically you are making minor changes to the shape of the data by transforming some horizontal data into a more vertical format. This is a common data wrangling need.</p>
<p>The data, “Salary.xslx”, are NBA salary data.</p>
<div id="ingest-excel-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Ingest Excel data</h2>
<ol style="list-style-type: decimal">
<li>Open Data
<ul>
<li><span class="or-menu">Create Project &gt; Web Addresses (URLs) &gt; </span> <code>https://github.com/libjohn/openrefine/raw/master/data/salary.xlsx</code></li>
<li><span class="or-menu">Next &gt;&gt; </span><br />
</li>
<li>You many want to give your project a pretty title</li>
<li><span class="or-menu">Create Project &gt;&gt; </span></li>
<li>Parse data as
<ol style="list-style-type: decimal">
<li>Worksheets to Import:
<ul>
<li><strong>Check</strong> “2013-2014 666 rows”</li>
<li><strong>UnCheck</strong> “2014-2015 599 rows”<br />
</li>
</ul></li>
<li><strong>UnCheck</strong> “Store blank rows”
<ul>
<li>Notice lines 20 &amp; 22 disappear<br />
</li>
</ul></li>
<li><strong>UnCheck</strong> “Parse Next” 1 lines as column headers
<ul>
<li>Notice the “Atlanta Hawks” are no longer the column header for the first column<br />
</li>
</ul></li>
</ol></li>
<li>Project name = <code>salary data</code> <span class="or-menu">&gt; Create Project </span><br />
</li>
</ul></li>
<li>Rename Columns: “Player”, “Salary”, “Notes” <a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a><br />
</li>
<li>Show as: rows to ‘25’ (notice row 21)</li>
</ol>
</div>
<div id="facets-2" class="section level2">
<h2><span class="header-section-number">3.2</span> Facets</h2>
<ol start="4" style="list-style-type: decimal">
<li>Remove all rows where ‘—-’ exist in the Player column
<ul>
<li><span class="or-menu">Player &gt; Facet &gt; Text Facet** &gt; </span>
<ul>
<li>Sort by: count &gt; click: ‘—-’ :<br />
</li>
<li>You should now have 29 matching rows that begin ‘—-’<br />
</li>
</ul></li>
<li><span class="or-menu">All &gt; Edit rows &gt; Remove all matching rows </span><br />
</li>
<li>Click: <strong>Remove All</strong> in the <strong>Facet/Filter</strong> sidebar</li>
</ul></li>
</ol>
<blockquote>
<p>Notice: in the next step, team names precede each team roster and are followed by two blank cells in the same row. Scroll through the screens (Click “next &gt;”) a few times; return to the first screen</p>
</blockquote>
<ol start="5" style="list-style-type: decimal">
<li>Make a column for team name and fill it.
<ul>
<li>Isolate team-name rows using a facet on the blank cells in the Salary column
<ol style="list-style-type: decimal">
<li><span class="or-menu">Salary &gt; Facet &gt; Customized facets &gt; Facet by blank </span>
<ul>
<li>Why do you think <strong>this doesn’t work</strong>? Those cells are actually filled with an invisible space (<code>\s</code>). They’re not actually blank and only appear blank. So, <strong>regular expressions</strong> to the rescue!<br />
</li>
</ul></li>
<li>Close the facet<br />
</li>
</ol></li>
<li><span class="or-menu">Salary &gt; Text filter &gt; check “regular expression” &gt; <code>^\s</code> </span>
<ul>
<li><code>\s</code> means “a space”; <code>^</code> means “must begin the line”<br />
</li>
</ul></li>
<li><strong>Mouseover</strong> the the “Cleveland Cavaliers” <strong>Salary cell</strong>:
<ul>
<li>edit &gt; highlight all the text EXCEPT the first space: “Tot $66,611,520” &gt; &lt;&lt;cut to clipboard&gt;&gt; &gt; Apply<br />
</li>
<li>BE SURE to leave a blank space where the Salary data was<br />
</li>
</ul></li>
<li>Edit the individual Notes cell for the “Cleveland Cavaliers” cell:
<ul>
<li>edit &gt; &lt;&lt;paste from clipboard&gt;&gt; “Tot $66,611,520” &gt; Apply<br />
</li>
<li>This time you do not need a leading blank space</li>
</ul></li>
</ul></li>
</ol>
</div>
<div id="text-filter" class="section level2">
<h2><span class="header-section-number">3.3</span> Text Filter</h2>
<ol start="6" style="list-style-type: decimal">
<li>Add the team name as a new column for each player then remove team name from the Player Column
<ol style="list-style-type: decimal">
<li><span class="or-menu">Player &gt; Edit column &gt; Add column based on this column … &gt; New column name = <code>Team</code> &gt; OK </span><br />
</li>
<li>Remove All facets<br />
</li>
<li><span class="or-menu">Team &gt; Edit cells &gt; Fill down </span><br />
</li>
<li><span class="or-menu">Salary &gt; Text filter &gt; check “regular expression” &gt; <code>^\s</code> </span><br />
</li>
<li><span class="or-menu">All &gt; Edit rows &gt; Remove all matching rows </span><br />
</li>
<li>Close (or “X out”) the Salary text filter</li>
</ol></li>
</ol>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p><span class="or-menu">Column Header &gt; Edit Column &gt; Rename this column </span><a href="hands-on-reshape-text-filter.html#fnref8">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="grel.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hands-on-dates.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
